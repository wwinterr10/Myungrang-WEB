--MEMBER TABLE 생성
CREATE TABLE MEMBER(
	ID 			 VARCHAR2(20)  PRIMARY KEY
	,PASSWORD 	 VARCHAR2(20)
	,NAME 		 VARCHAR2(20)  NOT NULL
	,BIRTH_DATE  DATE 		   NOT NULL
	,PHONE 	 	 VARCHAR2(12)  NOT NULL
	,POST 		 CHAR(6) 	   NOT NULL
	,BASIC_ADDR	 VARCHAR2(200) NOT NULL
	,DETAIL_ADDR VARCHAR2(200) NOT NULL
	,EMAIL 		 VARCHAR2(50)  NOT NULL UNIQUE
	,REG_DATE 	 DATE    DEFAULT SYSDATE
	,GRADE 		 CHAR(1) DEFAULT 'B'
	,ADMIN 		 CHAR(1)
	,OAUTH       CHAR(1)
);

--BREED TABLE 생성
CREATE TABLE BREED(
	NO 			NUMBER(10) 	 PRIMARY KEY
	,DOG_SIZE 	CHAR(1) 	 NOT NULL
	,BREED_NAME VaRCHAR2(20) NOT NULL
);

--DOG TABLE 생성
CREATE TABLE DOG(
	NO NUMBER(10) PRIMARY KEY
	,MEMBER_ID VARCHAR2(20) NOT NULL
	,NAME VARCHAR2(20) NOT NULL
	,BIRTH_DATE DATE
	,BREED_CODE NUMBER(5) NOT NULL
	,CONSTRAINT FK_DOG_MEMBER_ID FOREIGN KEY(MEMBER_ID) REFERENCES MEMBER(ID) ON DELETE CASCADE
	,CONSTRAINT FK_DOG_BREED_CODE FOREIGN KEY(BREED_CODE) REFERENCES BREED(NO) ON DELETE CASCADE
);

--DOG, BREED TABLE의 PK에 일련번호 생성
CREATE SEQUENCE SEQ_DOG_NO NOCACHE;
CREATE SEQUENCE SEQ_BREED_NO NOCACHE;

--개인테이블
--DISEASE TABLE
CREATE TABLE DISEASE(
	DISEASE_CODE VARCHAR(10) PRIMARY KEY
	,DISEASE_NAME VARCHAR(20)
	,PRICE NUMBER(10) NOT NULL
);

--HEALTH TABLE
CREATE TABLE HEALTH(
	NO NUMBER(10) PRIMARY KEY
	,DOG_NO NUMBER(10) NOT NULL
	,VISIT_DATE DATE DEFAULT SYSDATE NOT NULL
	,DISEASE_CODE VARCHAR2(10) NOT NULL
	,SIGNIFICANT VARCHAR2(300)
	,CONSTRAINT FK_HEALTH_DOG_NO FOREIGN KEY(DOG_NO) REFERENCES DOG(NO) ON DELETE CASCADE
	,CONSTRAINT FK_HEALTH_DISEASE_CODE FOREIGN KEY(DISEASE_CODE) REFERENCES DISEASE(DISEASE_CODE) ON DELETE CASCADE
);

--APPOINTMENT TABLE
CREATE TABLE APPOINTMENT(
	NO NUMBER(10) PRIMARY KEY
	,DOG_NO NUMBER(10) NOT NULL
	,MEMBER_ID VARCHAR2(20) NOT NULL
	,APPOINTMENT_DATE DATE NOT NULL
	,APPOINTMENT_TIME VARCHAR2(10) NOT NULL
	,CONSTRAINT FK_DOG_APPOINMENT_DOG_NO FOREIGN KEY(DOG_NO) REFERENCES DOG(NO) ON DELETE CASCADE
	,CONSTRAINT FK_DOG_APPOINMENT_MEMBER_ID FOREIGN KEY(MEMBER_ID) REFERENCES MEMBER(ID) ON DELETE CASCADE
);

--HEALTH, APPOINTMENT TABLE의 PK에 일련번호 생성
CREATE SEQUENCE SEQ_HEALTH_NO NOCACHE;
CREATE SEQUENCE SEQ_APPOINTMENT_NO NOCACHE;


--INSERT DATA
--BREED, DISEASE TABLE에 기본 자료 데이터 삽입
INSERT INTO BREED(NO, DOG_SIZE, BREED_NAME)
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Unknown');
INSERT INTO BREED(NO, DOG_SIZE, BREED_NAME)
VALUES(SEQ_BREED_NO.NEXTVAL, 'M', 'Unknown');
INSERT INTO BREED(NO, DOG_SIZE, BREED_NAME)
VALUES(SEQ_BREED_NO.NEXTVAL, 'L', 'Unknown');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Pomeranian');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Maltese');
VALUES(SEQ_BREED_NO.NEXTVAL, 'L', 'Golden Retriever');
VALUES(SEQ_BREED_NO.NEXTVAL, 'L', 'Siberian Husky');
VALUES(SEQ_BREED_NO.NEXTVAL, 'M', 'French Bulldog');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Shih Tzu');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Chihuahua');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Yorkshire Terrier');
VALUES(SEQ_BREED_NO.NEXTVAL, 'S', 'Cocker Spaniel');
COMMIT;

INSERT INTO DISEASE(DISEASE_CODE, DISEASE_NAME, PRICE)
VALUES('B01', '손발톱케어', 10000);
VALUES('B11', '애견목욕(S)', 30000);
VALUES('B12', '애견목욕(M)', 50000);
VALUES('B13', '애견목욕(L)', 70000);
VALUES('B21', '애견미용(S)', 50000);
VALUES('B22', '애견미용(M)', 70000);
VALUES('B23', '애견미용(L)', 100000);
VALUES('B31', '토탈케어(S)', 75000);
VALUES('B32', '토탈케어(M)', 95000);
VALUES('B33', '토탈케어(L)', 160000);
VALUES('C00', '이상없음', 5000);
VALUES('Z01', '건강검진-기본', 200000);
VALUES('Z02', '건강검진-상세', 450000);
VALUES('Z21', '심장사상충', 10000);
VALUES('Z22', '켄넬코프', 15000);
VALUES('Z23', '종합백신', 25000);
VALUES('Z24', '광견병', 20000);
VALUES('L31', '습진', 30000);
VALUES('L32', '말라세지아', 50000);
VALUES('H61', '외이염', 40000);
VALUES('H62', '중이염', 60000);
VALUES('F51', '설사', 50000);
VALUES('F52', '구토', 50000);
VALUES('H41', '백내장', 200000);
VALUES('H42', '녹내장', 300000);
VALUES('H43', '안구건조', 30000);
VALUES('M21', '슬개골탈구', 800000);
VALUES('M22', '디스크', 1000000);
VALUES('M23', '단순골절', 400000);
COMMIT;


--MEMBER, DOG TABLE에 TEST DATE 삽입
INSERT INTO MEMBER(ID, PASSWORD, NAME, BIRTH_DATE, PHONE, POST, BASIC_ADDR, DETAIL_ADDR, EMAIL, ADMIN)
VALUES('hmJo', '1234', '조항민', '950909', '01098765432', '10793', '부산시 해운대구', '푸르지오', 'hangminjo@geniemail.com', null);
VALUES('doctorHaley', '1234', '헤일리', '880101', '01012341234', '101010', '경기도 성남시 수정구 수정로 398', '도그월드 1층', 'doctorHaley@geniemail.com', 'A');
VALUES('doctorAlex', '1234', '알렉스', '890101', '01012341234', '101010', '경기도 성남시 수정구 수정로 398', '도그월드 1층', 'doctorAlex@geniemail.com', 'A');
VALUES('winter', '1234', '겨울', '010101', '01012341234', '101010', '경기도 성남시 수정구 수정로 333', '한국폴리텍대학', 'winter@geniemail.com', null);
VALUES('borim', '1234', '보림', '990220', '01011112222', '111111', '서울시 동작구', '롯데캐슬', 'borim@geniemail.com', null);
VALUES('wonho', '1234', '원호', '930101', '01011112222', '111111', '서울시 송파구', '파크리오', 'fishhama@geniemail.com', null);
VALUES('yechan', '1234', '예찬', '970101', '01011112222', '111111', '경기도 성남', '포레스티아', 'yechan@geniemail.com', null);
VALUES('jungmi', '1234', '정미', '940101', '01011112222', '111111', '경기도 성남', '한국폴리텍', 'jungmi@geniemail.com', null);
VALUES('seongsoo', '1234', '성수', '950101', '01011112222', '111111', '경기도 성남', '롯데캐슬', 'kimss@geniemail.com', null);
VALUES('hoon', '1234', '승훈', '990101', '01011112222', '111111', '서울시 송파구', '자이아파트', 'seunghoon@geniemail.com', null);
COMMIT;

INSERT INTO DOG(NO, MEMBER_ID, NAME, BIRTH_DATE, BREED_CODE)
VALUES(SEQ_DOG_NO.NEXTVAL, 'winter', '뚱이', '120713', 1);
VALUES(SEQ_DOG_NO.NEXTVAL, 'borim', '말랑', '130101', 2);
VALUES(SEQ_DOG_NO.NEXTVAL, 'wonho', '나나', '160101', 3);
VALUES(SEQ_DOG_NO.NEXTVAL, 'wonho', '뚜비', '140101', 4);
VALUES(SEQ_DOG_NO.NEXTVAL, 'yechan', '파이어', '240101', 5);
VALUES(SEQ_DOG_NO.NEXTVAL, 'jungmi', '쫑이', '190101', 6);
VALUES(SEQ_DOG_NO.NEXTVAL, 'seongsoo', '흰둥이', '210101', 2);
VALUES(SEQ_DOG_NO.NEXTVAL, 'hoon', '민', '220101', 7);
VALUES(SEQ_DOG_NO.NEXTVAL, 'hoon', '정음', '230101', 7);
COMMIT;


--HEALTH, APPOINTMENT TABLE에 TEST DATE 삽입
INSERT INTO APPOINTMENT(NO, DOG_NO, MEMBER_ID, APPOINTMENT_DATE, APPOINTMENT_TIME)
VALUES(SEQ_APPOINTMENT_NO.NEXTVAL, 1, 'winter', '240626', '14:00');
COMMIT;

INSERT INTO HEALTH(NO, DOG_NO, VISIT_DATE, DISEASE_CODE, SIGNIFICANT)
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '170226', 'H43', '안약 처방');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '170315', 'B01', '귀 안쪽 염증 의심');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '170402', 'B11', '눈, 귀 정상');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '170613', 'Z02', '슬개골 탈구 조심');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '171130', 'L32', '가려움, 붉은 반점, 알약 처방');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '171211', 'L32', '약 2주분 추가 처방');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '171229', 'B31', '피부 괜찮아보임');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '180410', 'B31', '건강 이상없음');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '180625', 'Z02', '다이어트 필요');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '181111', 'B31', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '190206', 'B11', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '190718', 'Z01', '살이 더찜, 슬개구 조심');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '191211', 'B31', '체중 감량 필수');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '200820', 'Z02', '더 주기적인 건강검진 필요');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '210202', 'Z02', '건강, 체중 모두 정상');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '210622', 'M21', '약 한달간 휴식 필요 권고');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '211030', 'B31', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '220419', 'Z01', '수술경과 매우좋음');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '221205', 'Z01', '노령견 진입, 6개월마다 건강검진 권유');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '230315', 'B31', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '230707', 'Z01', '치석제거 스케일링');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '230830', 'B31', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '240102', 'B31', '');
VALUES(SEQ_HEALTH_NO.NEXTVAL, '1', '240304', 'Z01', '7월-8월 사이 재건강검진 필요');


--DB LINK 접속 쿼리
CREATE DATABASE LINK DOG_XE CONNECT TO dogworld identified BY "dog1234" 
USING '(DESCRIPTION = 
(ADDRESS = (PROTOCOL=TCP)(HOST=172.31.9.175)(PORT=1521)) 
(CONNECT_DATA = (SERVER = DEDICATED) (SERVICE_NAME = XE)) 
)';

--DB LINK 접속을 위해 기존 TABLE명 변경
ALTER TABLE MEMBER RENAME TO MEMBER_P;
ALTER TABLE DOG  RENAME TO DOG_P;
ALTER TABLE BREED RENAME TO BREED_P;
--SYNONYM 설정
CREATE SYNONYM BREED FOR BREED@DOG_XE;
CREATE SYNONYM MEMBER FOR MEMBER@DOG_XE;
CREATE SYNONYM DOG FOR DOG@DOG_XE;
